!function(p){"use strict";function e(e,s){var t={action:"get_salesforce_object_description",include:["fields","recordTypeInfos"],field_type:"datetime",salesforce_object:e},a=".sfwp-m-salesforce-record-types-allowed",o=".sfwp-m-salesforce-record-types-allowed.sfwp-m-salesforce-record-types-allowed-"+e+" .checkboxes",c="",l=".sfwp-m-pull-trigger-field",r="#sfwp-pull-trigger-field",n="",d=p(r+" option").first().text();p(a).attr("class","sfwp-m-fieldmap-subgroup sfwp-m-salesforce-record-types-allowed").addClass("sfwp-m-salesforce-record-types-allowed-"+e),p(a).addClass("record-types-allowed-template"),p(l).addClass("pull-trigger-field-template"),i(),!0===s&&(p(o+' input[type="checkbox"]').prop("checked",!1),p(r).val("")),0<p(o+"input:checked").length&&p(a).removeClass("record-types-allowed-template"),""!==p(r).val()?p(l).removeClass("pull-trigger-field-template"):n+='<option value="">'+d+"</option>",p.ajax({type:"POST",url:ajaxurl,data:t,beforeSend:function(){p(".spinner-salesforce").addClass("is-active")},success:function(e){0<p(e.data.recordTypeInfos).length&&p.each(e.data.recordTypeInfos,function(e,s){c+='<label><input type="checkbox" class="form-checkbox" value="'+e+'" name="salesforce_record_types_allowed['+e+']" id="salesforce_record_types_allowed-'+e+'"> '+s+"</label>"}),p(o).html(c),0<p(e.data.fields).length&&""!==n&&(p.each(e.data.fields,function(e,s){n+='<option value="'+s.name+'">'+s.label+"</option>"}),p(r).html(n))},complete:function(){p(".spinner-salesforce").removeClass("is-active"),""!==c&&p(a).removeClass("record-types-allowed-template"),d!==n&&p(l).removeClass("pull-trigger-field-template")}})}function i(){var e=p(".sfwp-m-salesforce-record-type-default"),s="#sfwp-salesforce-record-type-default",t="",a=p(s+" option").first().text(),o="";t+='<option value="">'+a+"</option>",0!==p('.sfwp-m-salesforce-record-types-allowed input[type="checkbox"]:checked').length?(p('.sfwp-m-salesforce-record-types-allowed input[type="checkbox"]:checked').each(function(e){1===p('.sfwp-m-salesforce-record-types-allowed input[type="checkbox"]:checked').length&&(o=" selected"),t+='<option value="'+p(this).val()+'"'+o+">"+p(this).closest("label").text()+"</option>"}),p(s).html(t),e.removeClass("record-type-default-template")):e.addClass("record-type-default-template")}function s(t,e){var s={action:"get_"+t+"_object_fields"},a=".column-"+t+"_field select",o="",c=p(a+" option").first().text();if(""===p(a).val()){if(o+='<option value="">'+c+"</option>","wordpress"===t)s.wordpress_object=e;else{if("salesforce"!==t)return o;s.salesforce_object=e}p.ajax({type:"POST",url:ajaxurl,data:s,beforeSend:function(){p(".spinner-"+t).addClass("is-active")},success:function(e){p.each(e.data.fields,function(e,s){"wordpress"===t?o+='<option value="'+s.key+'">'+s.key+"</option>":"salesforce"===t&&(o+='<option value="'+s.name+'">'+s.label+"</option>")}),p(a).html(o)},complete:function(){p(".spinner-"+t).removeClass("is-active")}})}}function t(){p("#add-field-mapping").click(function(){var e=p("#sfwp-salesforce-object").val(),s=p("#sfwp-wordpress-object").val(),t=(new Date).getUTCMilliseconds(),a=p("table.fields tbody tr").last(),o=a.attr("data-key");return o=new RegExp(o,"g"),p(this).text("Add another field mapping"),""!==s&&""!==e?(function(t,a,e){var s="";s=jQuery.fn.select2?e.find("select").select2("destroy").end().clone(!0).removeClass("fieldmap-template"):e.clone(!0);p(s).attr("data-key",a),p(s).each(function(){p(this).html(function(e,s){return s.replace(t,a)})}),p("table.fields tbody").append(s),jQuery.fn.select2&&(e.find("select").select2(),s.find("select").select2())}(o,t,a),p(this).parent().find(".missing-object").remove()):p(this).parent().prepend('<div class="error missing-object"><span>You have to pick a WordPress object and a Salesforce object to add field mapping.</span></div>'),!1})}function a(){var e={action:"refresh_mapped_data",mapping_id:p("#mapping_id_ajax").val()};p.post(ajaxurl,e,function(e){!0===e.success&&(p("td.last_sync_message").text(e.data.last_sync_message),p("td.last_sync_action").text(e.data.last_sync_action),p("td.last_sync_status").text(e.data.last_sync_status),p("td.last_sync").text(e.data.last_sync),"1"===e.data.last_sync_status&&p("td.last_sync_status").text("success"))})}function o(){0<p(".object-sync-for-salesforce-enable-soap").length&&(p(".object-sync-for-salesforce-enable-soap input").is(":checked")?p(".object-sync-for-salesforce-soap-wsdl-path").show():p(".object-sync-for-salesforce-soap-wsdl-path").hide())}p(document).ready(function(){var e,s,t,a,o,c,l;e=p("select#sfwp-wordpress-object").val(),s=!1,t={action:"get_wordpress_object_description",include:["statuses"],wordpress_object:e},o="."+(a=".sfwp-m-wordpress-statuses")+"."+a+"-"+e+" #sfwp-default-status",l="."+(c=".sfwp-m-wordpress-drafts")+"."+c+"-"+e+" .checkbox",p(a).attr("class","sfwp-m-fieldmap-group-fields select "+a).addClass(a+"-"+e),p(a).addClass("wordpress-statuses-template"),p(c).addClass("sfwp-m-drafts-template"),!0===s&&(p(o+' input[type="checkbox"]').prop("checked",!1),p(l+' input[type="checkbox"]').prop("checked",!1)),0<p(o+"input:checked").length&&p(a).removeClass("wordpress-statuses-template"),0<p(l+"input:checked").length&&p(c).removeClass("sfwp-m-drafts-template"),p.ajax({type:"POST",url:ajaxurl,data:t,beforeSend:function(){p(".spinner-wordpress").addClass("is-active")},success:function(e){0<p(e.data.statuses).length&&p.each(e.data.statuses,function(e,s){allowedTypeOptions+='<label><input type="checkbox" class="form-checkbox" value="'+e+'" name="salesforce_record_types_allowed['+e+']" id="salesforce_record_types_allowed-'+e+'"> '+s+"</label>"}),p(allowedTypesFieldGroup).html(allowedTypeOptions),array1.filter(function(e){return-1!==array2.indexOf(e)})},complete:function(){p(".spinner-wordpress").removeClass("is-active"),""!==allowedTypeOptions&&p(allowedTypesContainer).removeClass("record-types-allowed-template"),firstDateOption!==dateFieldOptions&&p(selectDateContainer).removeClass("pull-trigger-field-template")}})}),p(document).on("change","select#sfwp-salesforce-object",function(){e(this.value,!0)}),p(document).on("change",'.sfwp-m-salesforce-record-types-allowed input[type="checkbox"]',function(){i()}),p(document).ready(function(){e(p("select#sfwp-salesforce-object").val(),!1)}),p(document).on("change","select#sfwp-wordpress-object",function(){var e;s("wordpress",p(this).val()),clearTimeout(e),e=setTimeout(function(){p("table.fields tbody tr").fadeOut(),p("table.fields tbody tr").not(".fieldmap-template").remove()},1e3)}),p(document).on("change","select#sfwp-salesforce-object",function(){var e;s("salesforce",p(this).val()),clearTimeout(e),e=setTimeout(function(){p("table.fields tbody tr").fadeOut(),p("table.fields tbody tr").not(".fieldmap-template").remove()},1e3)}),p(document).ready(function(){s("wordpress",p("select#sfwp-wordpress-object").val()),s("salesforce",p("select#sfwp-salesforce-object").val())}),p(document).on("click",".column-is_prematch input",function(){p(".column-is_prematch input").not(this).prop("checked",!1)}),p(document).on("click",".column-is_key input",function(){p(".column-is_key input").not(this).prop("checked",!1)}),p(document).on("click",".sfwp-a-fieldmap-field-action",function(e){e.preventDefault()}),p(document).on("click",".sfwp-a-fieldmap-field-action-edit",function(e){p(this).closest(".sfwp-a-fieldmap-values").toggleClass("sfwp-a-fieldmap-values-expanded")}),p(document).on("click",".sfwp-a-fieldmap-field-action-delete",function(e){}),p(document).ready(function(){t(),jQuery.fn.select2&&(p("select#sfwp-wordpress-object").select2(),p("select#sfwp-salesforce-object").select2(),p("select#sfwp-salesforce-record-type-default").select2(),p("select#sfwp-pull-trigger-field").select2(),p(".sfwp-fieldmap-form-field select").select2())}),p(document).ready(function(){p("#clear-sfwp-cache").click(function(){var s=p(this);return p.post(ajaxurl,{action:"clear_sfwp_cache"},function(e){!0===e.success&&!0===e.data.success&&s.parent().html(e.data.message).fadeIn()}),!1}),p(".salesforce_user_ajax_message").hide(),0<p("#wordpress_object_ajax").length&&p(".push_to_salesforce_button").on("click",function(){var e={action:"push_to_salesforce",wordpress_object:p("#wordpress_object_ajax").val(),wordpress_id:p("#wordpress_id_ajax").val(),salesforce_id:p("#salesforce_id_ajax").val()};return p.post(ajaxurl,e,function(e){!0===e.success&&(a(),p(".salesforce_user_ajax_message").width(p(".mapped-salesforce-user").width()-27),p(".salesforce_user_ajax_message").html("<p>This object has been pushed to Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1}),p(".salesforce_user_ajax_message").hide(),p(".pull_from_salesforce_button").on("click",function(){var e={action:"pull_from_salesforce",salesforce_id:p("#salesforce_id_ajax").val(),wordpress_object:p("#wordpress_object_ajax").val()};return p.post(ajaxurl,e,function(e){!0===e.success&&(a(),p(".salesforce_user_ajax_message").width(p(".mapped-salesforce-user").width()-27),p(".salesforce_user_ajax_message").html("<p>This object has been pulled from Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1})}),p(document).on("change",".object-sync-for-salesforce-enable-soap input",function(){o()}),p(document).ready(function(){o()})}(jQuery);