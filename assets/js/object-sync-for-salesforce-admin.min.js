!function(l){"use strict";function e(){var s,e=function(e,t){clearTimeout(s),s=setTimeout(e,t)};(s=0)===l(".salesforce_record_types_allowed > *").length&&l(".salesforce_record_types_allowed").hide(),0===l(".salesforce_record_type_default > *").length&&l(".salesforce_record_type_default").hide(),0===l(".pull_trigger_field > *").length&&l(".pull_trigger_field").hide(),l("#salesforce_object").on("change",function(){var t=this;e(function(){var e={action:"get_salesforce_object_description",include:["fields","recordTypeInfos"],field_type:"datetime",salesforce_object:t.value};l.post(ajaxurl,e,function(e){var s="",a="",o="";0<l(e.data.recordTypeInfos).length&&(s+='<label for="salesforce_record_types_allowed">Allowed Record Types:</label><div class="checkboxes">',l.each(e.data.recordTypeInfos,function(e,t){s+='<label><input type="checkbox" class="form-checkbox" value="'+e+'" name="salesforce_record_types_allowed['+e+']" id="salesforce_record_types_allowed-'+e+'"> '+t+"</label>"}),s+="</div>",a+='<label for="salesforce_record_type_default">Default Record Type:</label>',a+='<select name="salesforce_record_type_default" id="salesforce_record_type_default"><option value="">- Select record type -</option>',l.each(e.data.recordTypeInfos,function(e,t){a+='<option value="'+e+'">'+t+"</option>"})),l(".salesforce_record_types_allowed").html(s),l(".salesforce_record_type_default").html(a),0<l(e.data.fields).length&&(o+='<label for="pull_trigger_field">Date field to trigger pull:</label>',o+='<select name="pull_trigger_field" id="pull_trigger_field"><option value="">- Select date field -</option>',l.each(e.data.fields,function(e,t){o+='<option value="'+t.name+'">'+t.label+"</option>"}),o+="</select>",o+='<p class="description">These are date fields that can cause WordPress to pull an update from Salesforce, according to the <code>salesforce_pull</code> class.</p>'),l(".pull_trigger_field").html(o),""!==s?l(".salesforce_record_types_allowed").show():l(".salesforce_record_types_allowed").hide(),""!==a?l(".salesforce_record_type_default").show():l(".salesforce_record_type_default").hide(),""!==o?l(".pull_trigger_field").show():l(".pull_trigger_field").hide(),jQuery.fn.select2&&(l("select#salesforce_record_type_default").select2(),l("select#pull_trigger_field").select2())})},1e3)})}function t(s,e){var t={action:"get_"+s+"_object_fields"},a=".column-"+s+"_field select",o="",c=l(a+" option").first().text();if(""===l(a).val()){if(o+='<option value="">'+c+"</option>","wordpress"===s)t.wordpress_object=e;else{if("salesforce"!==s)return o;t.salesforce_object=e}l.ajax({type:"POST",url:ajaxurl,data:t,beforeSend:function(){l(".spinner-"+s).addClass("is-active")},success:function(e){l.each(e.data.fields,function(e,t){"wordpress"===s?o+='<option value="'+t.key+'">'+t.key+"</option>":"salesforce"===s&&(o+='<option value="'+t.name+'">'+t.label+"</option>")}),l(a).html(o)},complete:function(){l(".spinner-"+s).removeClass("is-active")}})}}function s(){l("#add-field-mapping").click(function(){var e=l("#salesforce_object").val(),t=l("#wordpress_object").val(),s=(new Date).getUTCMilliseconds(),a=l("table.fields tbody tr").last(),o=a.attr("data-key");return o=new RegExp(o,"g"),l(this).text("Add another field mapping"),""!==t&&""!==e?(function(s,a,e){var t="";t=jQuery.fn.select2?e.find("select").select2("destroy").end().clone(!0).removeClass("fieldmap-template"):e.clone(!0);l(t).attr("data-key",a),l(t).each(function(){l(this).html(function(e,t){return t.replace(s,a)})}),l("table.fields tbody").append(t),jQuery.fn.select2&&(e.find("select").select2(),t.find("select").select2())}(o,s,a),l(this).parent().find(".missing-object").remove()):l(this).parent().prepend('<div class="error missing-object"><span>You have to pick a WordPress object and a Salesforce object to add field mapping.</span></div>'),!1})}function a(){var e={action:"refresh_mapped_data",mapping_id:l("#mapping_id_ajax").val()};l.post(ajaxurl,e,function(e){!0===e.success&&(l("td.last_sync_message").text(e.data.last_sync_message),l("td.last_sync_action").text(e.data.last_sync_action),l("td.last_sync_status").text(e.data.last_sync_status),l("td.last_sync").text(e.data.last_sync),"1"===e.data.last_sync_status&&l("td.last_sync_status").text("success"))})}function o(){0<l(".object-sync-for-salesforce-enable-soap").length&&(l(".object-sync-for-salesforce-enable-soap input").is(":checked")?l(".object-sync-for-salesforce-soap-wsdl-path").show():l(".object-sync-for-salesforce-soap-wsdl-path").hide())}l(document).ready(function(){wordpressObjectRecordSettings()}),l(document).ready(function(){e()}),l(document).on("change","select#wordpress_object",function(){var e;t("wordpress",l(this).val()),clearTimeout(e),e=setTimeout(function(){l("table.fields tbody tr").fadeOut(),l("table.fields tbody tr").not(".fieldmap-template").remove()},1e3)}),l(document).on("change","select#salesforce_object",function(){var e;t("salesforce",l(this).val()),clearTimeout(e),e=setTimeout(function(){l("table.fields tbody tr").fadeOut(),l("table.fields tbody tr").not(".fieldmap-template").remove()},1e3)}),l(document).ready(function(){t("wordpress",l("select#wordpress_object").val()),t("salesforce",l("select#salesforce_object").val())}),l(document).on("click",".column-is_prematch input",function(){l(".column-is_prematch input").not(this).prop("checked",!1)}),l(document).on("click",".column-is_key input",function(){l(".column-is_key input").not(this).prop("checked",!1)}),l(document).ready(function(){s(),jQuery.fn.select2&&(l("select#wordpress_object").select2(),l("select#salesforce_object").select2(),l("select#salesforce_record_type_default").select2(),l("select#pull_trigger_field").select2(),l(".column-wordpress_field select").select2(),l(".column-salesforce_field select").select2())}),l(document).ready(function(){l("#clear-sfwp-cache").click(function(){var t=l(this);return l.post(ajaxurl,{action:"clear_sfwp_cache"},function(e){!0===e.success&&!0===e.data.success&&t.parent().html(e.data.message).fadeIn()}),!1}),l(".salesforce_user_ajax_message").hide(),0<l("#wordpress_object_ajax").length&&l(".push_to_salesforce_button").on("click",function(){var e={action:"push_to_salesforce",wordpress_object:l("#wordpress_object_ajax").val(),wordpress_id:l("#wordpress_id_ajax").val(),salesforce_id:l("#salesforce_id_ajax").val()};return l.post(ajaxurl,e,function(e){!0===e.success&&(a(),l(".salesforce_user_ajax_message").width(l(".mapped-salesforce-user").width()-27),l(".salesforce_user_ajax_message").html("<p>This object has been pushed to Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1}),l(".salesforce_user_ajax_message").hide(),l(".pull_from_salesforce_button").on("click",function(){var e={action:"pull_from_salesforce",salesforce_id:l("#salesforce_id_ajax").val(),wordpress_object:l("#wordpress_object_ajax").val()};return l.post(ajaxurl,e,function(e){!0===e.success&&(a(),l(".salesforce_user_ajax_message").width(l(".mapped-salesforce-user").width()-27),l(".salesforce_user_ajax_message").html("<p>This object has been pulled from Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1})}),l(document).on("change",".object-sync-for-salesforce-enable-soap input",function(){o()}),l(document).ready(function(){o()})}(jQuery);