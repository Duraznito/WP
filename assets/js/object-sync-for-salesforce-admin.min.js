"use strict";!function(c){function s(){0<c(".object-sync-for-salesforce-enable-soap").length&&(c(".object-sync-for-salesforce-enable-soap input").is(":checked")?c(".object-sync-for-salesforce-soap-wsdl-path").show():c(".object-sync-for-salesforce-soap-wsdl-path").hide())}function r(){c("#add-field-mapping").click(function(){var e,o,s,t=c("#salesforce_object").val(),a=c("#wordpress_object").val();return c(this).text("Add another field mapping"),""!==a&&""!==t?(e=Math.floor(Date.now()/1e3),o=e,s={action:"get_wp_sf_object_fields",wordpress_object:a,salesforce_object:t},c.post(ajaxurl,s,function(e){var t="",a="",s="";t+='<select name="wordpress_field['+o+']" id="wordpress_field-'+o+'">',t+='<option value="">- Select WordPress field -</option>',c.each(e.data.wordpress,function(e,s){t+='<option value="'+s.key+'">'+s.key+"</option>"}),t+="</select>",a+='<select name="salesforce_field['+o+']" id="salesforce_field-'+o+'">',a+='<option value="">- Select Salesforce field -</option>',c.each(e.data.salesforce,function(e,s){a+='<option value="'+s.name+'">'+s.label+"</option>"}),s='<tr><td class="column-wordpress_field">'+t+'</td><td class="column-salesforce_field">'+(a+="</select>")+'</td><td class="column-is_prematch"><input type="checkbox" name="is_prematch['+o+']" id="is_prematch-'+o+'" value="1" /><td class="column-is_key"><input type="checkbox" name="is_key['+o+']" id="is_key-'+o+'" value="1" /></td><td class="column-direction"><div class="radios"><label><input type="radio" value="sf_wp" name="direction['+o+']" id="direction-'+o+'-sf-wp">  Salesforce to WordPress</label><label><input type="radio" value="wp_sf" name="direction['+o+']" id="direction-'+o+'-wp-sf">  WordPress to Salesforce</label><label><input type="radio" value="sync" name="direction['+o+']" id="direction-'+o+'-sync" checked>  Sync</label></div></td><td class="column-is_delete"><input type="checkbox" name="is_delete['+o+']" id="is_delete-'+o+'" value="1" /></td></tr>',c("table.fields tbody").append(s),jQuery.fn.select2&&(c(".column-wordpress_field select").select2(),c(".column-salesforce_field select").select2())}),c(this).parent().find(".missing-object").remove()):c(this).parent().prepend('<div class="error missing-object"><span>You have to pick a WordPress object and a Salesforce object to add field mapping.</span></div>'),!1})}function d(){var e={action:"refresh_mapped_data",mapping_id:c("#mapping_id_ajax").val()};c.post(ajaxurl,e,function(e){!0===e.success&&(c("td.last_sync_message").text(e.data.last_sync_message),c("td.last_sync_action").text(e.data.last_sync_action),c("td.last_sync_status").text(e.data.last_sync_status),c("td.last_sync").text(e.data.last_sync),"1"===e.data.last_sync_status&&c("td.last_sync_status").text("success"))})}c(document).on("change",".object-sync-for-salesforce-enable-soap input",function(){s()}),c(document).on("click",".column-is_prematch input",function(){c(".column-is_prematch input").not(this).prop("checked",!1)}),c(document).on("click",".column-is_key input",function(){c(".column-is_key input").not(this).prop("checked",!1)}),c(document).ready(function(){var e,t,a,o,l;s(),jQuery.fn.select2&&(c("select#wordpress_object").select2(),c("select#wordpress_object_default_status").select2(),c("select#salesforce_object").select2(),c("select#salesforce_record_type_default").select2(),c("select#pull_trigger_field").select2(),c(".column-wordpress_field select").select2(),c(".column-salesforce_field select").select2()),c("#wordpress_object, #salesforce_object").on("change",function(){clearTimeout(e),e=setTimeout(function(){c("table.fields tbody tr").fadeOut(),c("table.fields tbody tr").remove()},1e3)}),c(document).ajaxStart(function(){c(".spinner").addClass("is-active")}).ajaxStop(function(){c(".spinner").removeClass("is-active")}),a=function(e,s){clearTimeout(t),t=setTimeout(e,s)},(t=0)===c(".wordpress_object_default_status > *").length&&c(".wordpress_object_default_status").hide(),c("#wordpress_object").on("change",function(){var s=this;a(function(){var e={action:"get_wordpress_object_description",include:["statuses"],wordpress_object:s.value};c.post(ajaxurl,e,function(e){var t="";0<c(e.data.statuses).length&&(t+='<label for="wordpress_object_default_status">Default '+s.value+" status:</label>",t+='<select name="wordpress_object_default_status" id="wordpress_object_default_status"><option value="">- Select '+s.value+" status -</option>",c.each(e.data.statuses,function(e,s){t+='<option value="'+e+'">'+s+"</option>"}),t+="</select>",t+='<p class="description">If this fieldmap allows new records to be created from Salesforce data, you can set a default status for them. You can override this default status by making a field that maps to the status field in the field settings below, or by using a developer hook to populate it.</p>',t+='<p class="description">The only core object that requires a status is the post. If you do not otherwise set a status, newly created posts will be drafts.</p>'),c(".wordpress_object_default_status").html(t),""!==t?c(".wordpress_object_default_status").show():c(".wordpress_object_default_status").hide(),jQuery.fn.select2&&c("select#wordpress_object_default_status").select2()})},1e3)}),l=function(e,s){clearTimeout(o),o=setTimeout(e,s)},(o=0)===c(".salesforce_record_types_allowed > *").length&&c(".salesforce_record_types_allowed").hide(),0===c(".salesforce_record_type_default > *").length&&c(".salesforce_record_type_default").hide(),0===c(".pull_trigger_field > *").length&&c(".pull_trigger_field").hide(),c("#salesforce_object").on("change",function(){var s=this;l(function(){var e={action:"get_salesforce_object_description",include:["fields","recordTypeInfos"],field_type:"datetime",salesforce_object:s.value};c.post(ajaxurl,e,function(e){var t="",a="",o="";0<c(e.data.recordTypeInfos).length&&(t+='<label for="salesforce_record_types_allowed">Allowed Record Types:</label><div class="checkboxes">',c.each(e.data.recordTypeInfos,function(e,s){t+='<label><input type="checkbox" class="form-checkbox" value="'+e+'" name="salesforce_record_types_allowed['+e+']" id="salesforce_record_types_allowed-'+e+'"> '+s+"</label>"}),t+="</div>",a+='<label for="salesforce_record_type_default">Default Record Type:</label>',a+='<select name="salesforce_record_type_default" id="salesforce_record_type_default"><option value="">- Select record type -</option>',c.each(e.data.recordTypeInfos,function(e,s){a+='<option value="'+e+'">'+s+"</option>"})),c(".salesforce_record_types_allowed").html(t),c(".salesforce_record_type_default").html(a),0<c(e.data.fields).length&&(o+='<label for="pull_trigger_field">Date field to trigger pull:</label>',o+='<select name="pull_trigger_field" id="pull_trigger_field"><option value="">- Select date field -</option>',c.each(e.data.fields,function(e,s){o+='<option value="'+s.name+'">'+s.label+"</option>"}),o+="</select>",o+='<p class="description">These are date fields that can cause WordPress to pull an update from Salesforce, according to the <code>salesforce_pull</code> class.</p>'),c(".pull_trigger_field").html(o),""!==t?c(".salesforce_record_types_allowed").show():c(".salesforce_record_types_allowed").hide(),""!==a?c(".salesforce_record_type_default").show():c(".salesforce_record_type_default").hide(),""!==o?c(".pull_trigger_field").show():c(".pull_trigger_field").hide(),jQuery.fn.select2&&(c("select#salesforce_record_type_default").select2(),c("select#pull_trigger_field").select2())})},1e3)}),r(),c(".salesforce_user_ajax_message").hide(),0<c("#wordpress_object_ajax").length&&c(".push_to_salesforce_button").on("click",function(){var e={action:"push_to_salesforce",wordpress_object:c("#wordpress_object_ajax").val(),wordpress_id:c("#wordpress_id_ajax").val(),salesforce_id:c("#salesforce_id_ajax").val()};return c.post(ajaxurl,e,function(e){!0===e.success&&(d(),c(".salesforce_user_ajax_message").width(c(".mapped-salesforce-user").width()-27),c(".salesforce_user_ajax_message").html("<p>This object has been pushed to Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1}),c(".pull_from_salesforce_button").on("click",function(){var e={action:"pull_from_salesforce",salesforce_id:c("#salesforce_id_ajax").val(),wordpress_object:c("#wordpress_object_ajax").val()};return c.post(ajaxurl,e,function(e){!0===e.success&&(d(),c(".salesforce_user_ajax_message").width(c(".mapped-salesforce-user").width()-27),c(".salesforce_user_ajax_message").html("<p>This object has been pulled from Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1}),c("#clear-sfwp-cache").click(function(){var s=c(this);return c.post(ajaxurl,{action:"clear_sfwp_cache"},function(e){!0===e.success&&!0===e.data.success&&s.parent().html(e.data.message).fadeIn()}),!1})})}(jQuery);